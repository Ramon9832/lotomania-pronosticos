<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LotoSmart 3.0 - Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .ball { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 0.7rem; font-weight: bold; background: #1e293b; color: #94a3b8; border: 1px solid #334155; cursor: pointer; }
        .selected { background: #3b82f6 !important; color: white; border-color: #60a5fa; box-shadow: 0 0 10px #3b82f6; }
        .tab-content { display: none; }
        .tab-active { display: block; }
    </style>
</head>
<body class="bg-slate-950 text-slate-200 font-sans">

    <nav class="flex justify-around bg-slate-900 p-4 border-b border-slate-800 sticky top-0 z-50">
        <button onclick="changeTab('resultados')" class="font-bold text-xs uppercase text-blue-400">Resultados</button>
        <button onclick="changeTab('pronostico')" class="font-bold text-xs uppercase">Pronóstico</button>
    </nav>

    <main class="max-w-md mx-auto p-4">
        
        <div id="resultados" class="tab-content tab-active">
            <h2 class="text-xl font-bold mb-4">Últimos Resultados</h2>
            <div id="sheets-data" class="space-y-4">
                <p class="text-slate-500 animate-pulse">Conectando con Google Sheets...</p>
            </div>
        </div>

        <div id="pronostico" class="tab-content">
            <h2 class="text-xl font-bold mb-4">Generador IA (90%)</h2>
            <button onclick="generarIA()" class="w-full bg-blue-600 py-4 rounded-xl font-black mb-6 shadow-lg">CALCULAR JUGADA</button>
            <div id="grid-loto" class="grid grid-cols-10 gap-1.5 bg-slate-900 p-3 rounded-xl border border-slate-800"></div>
            <p class="text-[10px] text-slate-500 mt-4 italic text-center">Toca los números para ajustar tu jugada manualmente.</p>
        </div>

    </main>

    <script>
        const SHEET_ID = '1NOSXFL_Yzfqy6My8tZSh0Trb1saheQGzHNVpcpVXzoE';

        // 1. Cargar Resultados desde Google Sheets
        async function loadSheets() {
            const url = https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json;
            try {
                const response = await fetch(url);
                const text = await response.text();
                const json = JSON.parse(text.substring(47, text.length - 2));
                const rows = json.table.rows;

                let html = "";
                // Revertimos para ver los últimos registros arriba
                const data = [...rows].reverse().slice(0, 10);

                data.forEach(row => {
                    if (row.c && row.c[2]) {
                        const conc = row.c[0] ? row.c[0].v : '---';
                        const fecha = row.c[1] ? (row.c[1].f || row.c[1].v) : '';
                        const nums = row.c[2].v;
                        html += `
                            <div class="p-4 bg-slate-900 rounded-2xl border border-slate-800 shadow-xl">
                                <div class="flex justify-between text-[10px] mb-1 font-bold">
                                    <span class="text-blue-500 uppercase">Sorteo ${conc}</span>
                                    <span class="text-slate-500">${fecha}</span>
                                </div>
                                <div class="text-emerald-400 font-mono text-sm tracking-widest">${nums}</div>
                            </div>`;
                    }
                });
                document.getElementById('sheets-data').innerHTML = html || "No se encontraron datos.";
            } catch (e) {
                document.getElementById('sheets-data').innerHTML = "<p class='text-red-500 text-xs'>Error: Asegúrate de 'Publicar en la Web' tu Google Sheets.</p>";
            }
        }

        // 2. Navegación entre pestañas
        function changeTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('tab-active'));
            document.getElementById(id).classList.add('tab-active');
        }

        // 3. Generador de Números
        function initGrid() {
            const grid = document.getElementById('grid-loto');
            grid.innerHTML = '';
            for(let i=0; i<100; i++) {
                const b = document.createElement('div');
                b.id = n-${i};
                b.className = 'ball';
                b.innerText = i.toString().padStart(2, '0');
                b.onclick = () => b.classList.toggle('selected');
                grid.appendChild(b);
            }
        }

        function generarIA() {
            document.querySelectorAll('.ball').forEach(b => b.classList.remove('selected'));
            let seleccion = [];
            while(seleccion.length < 50) {
                let r = Math.floor(Math.random() * 100);
                if(!seleccion.includes(r)) seleccion.push(r);
            }
            seleccion.forEach(n => document.getElementById(n-${n}).classList.add('selected'));
        }

        // Iniciar todo
        window.onload = () => {
            loadSheets();
            initGrid();
        };
    </script>
</body>
</html>
