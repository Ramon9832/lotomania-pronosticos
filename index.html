<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Lotoman√≠a ‚Äì Sistema Profesional Avanzado</title>

<style>
body { font-family: Arial, sans-serif; background:#eef2f5; padding:20px }
.card { background:#fff; padding:15px; margin-bottom:15px; border-radius:6px }
button { padding:10px 14px; margin:5px; font-size:14px }
.resultado { font-weight:bold; line-height:1.6 }
.ok { color:green }
.error { color:red }
hr { margin:10px 0 }
</style>
</head>

<body>

<h2>üéØ Lotoman√≠a ‚Äì Sistema Profesional Avanzado</h2>

<div class="card">
  <h3>Hist√≥rico</h3>
  <textarea id="historico" rows="8" style="width:100%"
    placeholder="Cada l√≠nea = 1 sorteo (20 n√∫meros)">
  </textarea><br><br>

  <!-- BOTONES EXISTENTES -->
  <button onclick="validar()">Validar hist√≥rico</button>
  <button onclick="generarModelo()">Modelo 50</button>

  <!-- BOTONES NUEVOS -->
  <button onclick="generarJuegos()">Juegos A / B / C</button>
  <button onclick="limpiar()">Limpiar</button>
</div>

<div class="card">
  <h3>Validaci√≥n</h3>
  <div id="outValidacion" class="resultado"></div>
</div>

<div class="card">
  <h3>Modelo profesional ‚Äì 50 n√∫meros</h3>
  <div id="outModelo" class="resultado"></div>
</div>

<div class="card">
  <h3>Juegos finales</h3>
  <div id="outJuegos" class="resultado"></div>
</div>

<script>
let sorteosValidos = [];
let modelo50 = [];

function leer() {
  return document.getElementById("historico").value
    .trim().split("\n")
    .map(l => l.trim().split(/[\s,]+/).map(n => parseInt(n,10)));
}

/* ================= VALIDACI√ìN ================= */
function validar() {
  sorteosValidos = [];
  let errores = [];

  leer().forEach((s,i) => {
    const u = new Set(s);
    if (
      s.length !== 20 ||
      u.size !== 20 ||
      s.some(n => isNaN(n) || n < 0 || n > 99)
    ) {
      errores.push(‚ùå Sorteo ${i+1} inv√°lido);
    } else {
      sorteosValidos.push(s);
    }
  });

  const out = document.getElementById("outValidacion");
  if (!sorteosValidos.length) {
    out.innerHTML = errores.join("<br>");
    out.className = "resultado error";
  } else {
    out.innerHTML = ‚úî Sorteos v√°lidos: ${sorteosValidos.length};
    out.className = "resultado ok";
  }
}

/* ================= MODELO 50 AVANZADO ================= */
function generarModelo() {
  if (!sorteosValidos.length) {
    alert("Valida el hist√≥rico primero");
    return;
  }

  let peso = sorteosValidos.map((_,i) => i+1);
  let freq = Array(100).fill(0);

  sorteosValidos.forEach((s,i) =>
    s.forEach(n => freq[n] += peso[i])
  );

  let ranking = freq
    .map((f,n)=>({n,f}))
    .sort((a,b)=>b.f-a.f);

  modelo50 = [];
  let dec = Array(10).fill(0);
  let pares = 0, impares = 0;

  for (let r of ranking) {
    let d = Math.floor(r.n/10);
    let esPar = r.n % 2 === 0;

    if (
      dec[d] < 5 &&
      pares < 25 && impares < 25 &&
      r.f > 0
    ) {
      modelo50.push(r.n);
      dec[d]++;
      esPar ? pares++ : impares++;
    }
    if (modelo50.length === 50) break;
  }

  modelo50.sort((a,b)=>a-b);
  document.getElementById("outModelo").innerHTML = fmt(modelo50);
}

/* ================= JUEGOS OPTIMIZADOS ================= */
function generarJuegos() {
  if (modelo50.length !== 50) {
    alert("Genera primero el modelo 50");
    return;
  }

  let calientes = modelo50.slice(0,25);
  let frios = modelo50.slice(25);

  let A = calientes.slice(0,20);
  let B = frios.slice(0,20);
  let C = calientes.slice(10,20).concat(frios.slice(10,20));

  document.getElementById("outJuegos").innerHTML =
    <strong>Juego A (tendencia)</strong><br>${fmt(A)}<hr> +
    <strong>Juego B (retorno)</strong><br>${fmt(B)}<hr> +
    <strong>Juego C (ruptura)</strong><br>${fmt(C)};
}

/* ================= UTIL ================= */
function fmt(a){ return a.map(n=>n.toString().padStart(2,"0")).join(" - ") }

function limpiar() {
  document.getElementById("historico").value="";
  document.getElementById("outValidacion").innerHTML="";
  document.getElementById("outModelo").innerHTML="";
  document.getElementById("outJuegos").innerHTML="";
  sorteosValidos=[]; modelo50=[];
}
</script>

</body>
</html>
